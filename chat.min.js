var Chat=function(){function Chat(){}return Chat.main=function(){"yes"==Socket.args[0]?(Socket.args[0]="0",Socket.init()):window.location.href=Socket.redirectUrl},Chat.processMessageBox=function(){var msgbox=document.getElementById("message");""!=msgbox.value.trim()&&(Chat.sendMessage(msgbox.value),msgbox.value="")},Chat.sendMessage=function(msg){""!=msg.trim()&&Socket.send(2,[msg.trim(),"0"])},Chat.disableReconnect=function(){Chat.shouldAttemptReconnect=!1},Chat.shouldReconnect=function(){return Chat.shouldAttemptReconnect},Chat.shouldAttemptReconnect=!0,Chat}();window.onload=function(){document.getElementById("message").onkeydown=function(e){var key="which"in e?e.which:e.keyCode;return 13!=key||e.shiftKey?void 0:(Chat.processMessageBox(),e.preventDefault&&e.preventDefault(),!1)},Chat.main()},window.onbeforeunload=function(){Chat.disableReconnect()};var Message=function(){function Message(){this.parts=[],this.valid=!0}return Message.error=function(){var ret=new Message;return ret.id=-1,ret.parts=[],ret.valid=!1,ret},Message.pack=function(id,arr){var ret;arr.length>255&&(arr=arr.slice(0,255));var headerSize=3,bodySize=0;for(var i in arr){if("string"==(typeof arr[i]).toLowerCase()||"number"==(typeof arr[i]).toLowerCase()){"number"==(typeof arr[i]).toLowerCase()&&(arr[i]=""+arr[i]);var length=arr[i].byteLength()}else var length=arr[i].length;if(254>length)headerSize+=1;else if(65535>=length)headerSize+=3;else{if(!(4294967295>=length))continue;headerSize+=5}bodySize+=length}ret=new Uint8Array(headerSize+bodySize);var ptrs=[3,headerSize];ret.set(id.packBytes(2));var actualSize=0;for(var i in arr){if("string"==(typeof arr[i]).toLowerCase())var length=arr[i].byteLength();else var length=arr[i].length;if(254>length)ret[ptrs[0]]=length,++ptrs[0];else if(65535>length)ret[ptrs[0]]=254,ret.set(length.packBytes(2),ptrs[0]+1),ptrs[0]+=3;else{if(!(4294967295>length))continue;ret[ptrs[0]]=255,ret.set(length.packBytes(4),ptrs[0]+1),ptrs[0]+=5}++actualSize,"string"==(typeof arr[i]).toLowerCase()?ret.set(arr[i].toByteArray(),ptrs[1]):ret.set(arr[i],ptrs[1]),ptrs[1]+=length}return ret[2]=actualSize,ret},Message.unpack=function(raw){var ret=new Message;if(raw.length<3)return Message.error();ret.id=raw.subarray(0,2).unpackBytes();for(var ptr=3,segments=raw[2],segmentLengths=[],i=0;segments>i;i++){if(raw.length<ptr)return Message.error();if(raw[ptr]<254)segmentLengths.push(raw[ptr]);else if(254==raw[ptr]){if(raw.length<ptr+2)return Message.error();segmentLengths.push(raw.subarray(ptr+1,ptr+3).unpackBytes()),ptr+=2}else if(255==raw[ptr]){if(raw.length<ptr+4)return Message.error();segmentLengths.push(raw.subarray(ptr+1,ptr+5).unpackBytes()),ptr+=4}ptr++}if(raw.length<ptr)return Message.error();for(var i=0;segments>i;i++){if(raw.length<ptr+segmentLengths[i])return Message.error();ret.parts[i]=raw.subarray(ptr,ptr+segmentLengths[i]),ptr+=segmentLengths[i]}return ret},Message}();!function(s,t,u){function mousePosition(a){if(s.event&&s.event.contentOverflow!==u)return{x:s.event.offsetX,y:s.event.offsetY};if(a.offsetX!==u&&a.offsetY!==u)return{x:a.offsetX,y:a.offsetY};var b=a.target.parentNode.parentNode;return{x:a.layerX-b.offsetLeft,y:a.layerY-b.offsetTop}}function $(a,b,c){a=t.createElementNS(svgNS,a);for(var d in b)a.setAttribute(d,b[d]);"[object Array]"!=Object.prototype.toString.call(c)&&(c=[c]);for(var i=0,len=c[0]&&c.length||0;len>i;i++)a.appendChild(c[i]);return a}function hsv2rgb(a){var R,G,B,X,C,h=a.h%360/60;C=a.v*a.s,X=C*(1-Math.abs(h%2-1)),R=G=B=a.v-C,h=~~h,R+=[C,X,0,0,X,C][h],G+=[X,C,C,X,0,0][h],B+=[0,0,X,C,C,X][h];var r=Math.floor(255*R),g=Math.floor(255*G),b=Math.floor(255*B);return{r:r,g:g,b:b,hex:"#"+(16777216|b|g<<8|r<<16).toString(16).slice(1)}}function rgb2hsv(a){var r=a.r,g=a.g,b=a.b;(a.r>1||a.g>1||a.b>1)&&(r/=255,g/=255,b/=255);var H,S,V,C;return V=Math.max(r,g,b),C=V-Math.min(r,g,b),H=0==C?null:V==r?(g-b)/C+(b>g?6:0):V==g?(b-r)/C+2:(r-g)/C+4,H=H%6*60,S=0==C?0:C/V,{h:H,s:S,v:V}}function slideListener(d,e,f){return function(a){a=a||s.event;var b=mousePosition(a);d.h=b.y/e.offsetHeight*360+hueOffset,d.s=d.v=1;var c=hsv2rgb({h:d.h,s:1,v:1});f.style.backgroundColor=c.hex,d.callback&&d.callback(c.hex,{h:d.h-hueOffset,s:d.s,v:d.v},{r:c.r,g:c.g,b:c.b},u,b)}}function pickerListener(d,e){return function(a){a=a||s.event;var b=mousePosition(a),width=e.offsetWidth,height=e.offsetHeight;d.s=b.x/width,d.v=(height-b.y)/height;var c=hsv2rgb(d);d.callback&&d.callback(c.hex,{h:d.h-hueOffset,s:d.s,v:d.v},{r:c.r,g:c.g,b:c.b},b)}}function ColorPicker(f,g,h){if(!(this instanceof ColorPicker))return new ColorPicker(f,g,h);if(this.h=0,this.s=1,this.v=1,h)this.callback=h,this.pickerElement=g,this.slideElement=f;else{var i=f;i.innerHTML=w,this.slideElement=i.getElementsByClassName("slide")[0],this.pickerElement=i.getElementsByClassName("picker")[0];var j=i.getElementsByClassName("slide-indicator")[0],k=i.getElementsByClassName("picker-indicator")[0];ColorPicker.fixIndicators(j,k),this.callback=function(a,b,c,d,e){ColorPicker.positionIndicators(j,k,e,d),g(a,b,c)}}if("SVG"==v){var l=slide.cloneNode(!0),m=picker.cloneNode(!0),n=l.getElementById("gradient-hsv"),o=l.getElementsByTagName("rect")[0];n.id="gradient-hsv-"+x,o.setAttribute("fill","url(#"+n.id+")");var p=[m.getElementById("gradient-black"),m.getElementById("gradient-white")],q=m.getElementsByTagName("rect");p[0].id="gradient-black-"+x,p[1].id="gradient-white-"+x,q[0].setAttribute("fill","url(#"+p[1].id+")"),q[1].setAttribute("fill","url(#"+p[0].id+")"),this.slideElement.appendChild(l),this.pickerElement.appendChild(m),x++}else this.slideElement.innerHTML=slide,this.pickerElement.innerHTML=picker;addEventListener(this.slideElement,"click",slideListener(this,this.slideElement,this.pickerElement)),addEventListener(this.pickerElement,"click",pickerListener(this,this.pickerElement)),enableDragging(this,this.slideElement,slideListener(this,this.slideElement,this.pickerElement)),enableDragging(this,this.pickerElement,pickerListener(this,this.pickerElement))}function addEventListener(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,!1)}function enableDragging(b,c,d){var e=!1;addEventListener(c,"mousedown",function(a){e=!0}),addEventListener(c,"mouseup",function(a){e=!1}),addEventListener(c,"mouseout",function(a){e=!1}),addEventListener(c,"mousemove",function(a){e&&d(a)})}function setColor(a,b,d,e){a.h=b.h%360,a.s=b.s,a.v=b.v;var c=hsv2rgb(a),f={y:a.h*a.slideElement.offsetHeight/360,x:0},g=a.pickerElement.offsetHeight,h={x:a.s*a.pickerElement.offsetWidth,y:g-a.v*g};return a.pickerElement.style.backgroundColor=hsv2rgb({h:a.h,s:1,v:1}).hex,a.callback&&a.callback(e||c.hex,{h:a.h,s:a.s,v:a.v},d||{r:c.r,g:c.g,b:c.b},h,f),a}var picker,slide,v=s.SVGAngle||t.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",hueOffset=15,svgNS="http://www.w3.org/2000/svg",w=['<div class="picker-wrapper">','<div class="picker"></div>','<div class="picker-indicator"></div>',"</div>",'<div class="slide-wrapper">','<div class="slide"></div>','<div class="slide-indicator"></div>',"</div>"].join("");"SVG"==v?(slide=$("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[$("defs",{},$("linearGradient",{id:"gradient-hsv",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[$("stop",{offset:"0%","stop-color":"#FF0000","stop-opacity":"1"}),$("stop",{offset:"13%","stop-color":"#FF00FF","stop-opacity":"1"}),$("stop",{offset:"25%","stop-color":"#8000FF","stop-opacity":"1"}),$("stop",{offset:"38%","stop-color":"#0040FF","stop-opacity":"1"}),$("stop",{offset:"50%","stop-color":"#00FFFF","stop-opacity":"1"}),$("stop",{offset:"63%","stop-color":"#00FF40","stop-opacity":"1"}),$("stop",{offset:"75%","stop-color":"#0BED00","stop-opacity":"1"}),$("stop",{offset:"88%","stop-color":"#FFFF00","stop-opacity":"1"}),$("stop",{offset:"100%","stop-color":"#FF0000","stop-opacity":"1"})])),$("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-hsv)"})]),picker=$("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[$("defs",{},[$("linearGradient",{id:"gradient-black",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[$("stop",{offset:"0%","stop-color":"#000000","stop-opacity":"1"}),$("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})]),$("linearGradient",{id:"gradient-white",x1:"0%",y1:"100%",x2:"100%",y2:"100%"},[$("stop",{offset:"0%","stop-color":"#FFFFFF","stop-opacity":"1"}),$("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})])]),$("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-white)"}),$("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-black)"})])):"VML"==v&&(slide=['<DIV style="position: relative; width: 100%; height: 100%">','<v:rect style="position: absolute; top: 0; left: 0; width: 100%; height: 100%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="0" color="red" color2="red" colors="8519f fuchsia;.25 #8000ff;24903f #0040ff;.5 aqua;41287f #00ff40;.75 #0bed00;57671f yellow"></v:fill>',"</v:rect>","</DIV>"].join(""),picker=['<DIV style="position: relative; width: 100%; height: 100%">','<v:rect style="position: absolute; left: -1px; top: -1px; width: 101%; height: 101%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="270" color="#FFFFFF" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>',"</v:rect>",'<v:rect style="position: absolute; left: 0px; top: 0px; width: 100%; height: 101%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="0" color="#000000" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>',"</v:rect>","</DIV>"].join(""),t.namespaces.v||t.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"));var x=0;ColorPicker.hsv2rgb=function(a){var b=hsv2rgb(a);return delete b.hex,b},ColorPicker.hsv2hex=function(a){return hsv2rgb(a).hex},ColorPicker.rgb2hsv=rgb2hsv,ColorPicker.rgb2hex=function(a){return hsv2rgb(rgb2hsv(a)).hex},ColorPicker.hex2hsv=function(a){return rgb2hsv(ColorPicker.hex2rgb(a))},ColorPicker.hex2rgb=function(a){return{r:parseInt(a.substr(1,2),16),g:parseInt(a.substr(3,2),16),b:parseInt(a.substr(5,2),16)}},ColorPicker.prototype.setHsv=function(a){return setColor(this,a)},ColorPicker.prototype.setRgb=function(a){return setColor(this,rgb2hsv(a),a)},ColorPicker.prototype.setHex=function(a){return setColor(this,ColorPicker.hex2hsv(a),u,a)},ColorPicker.positionIndicators=function(a,b,c,d){c&&(b.style.left="auto",b.style.right="0px",b.style.top="0px",a.style.top=c.y-a.offsetHeight/2+"px"),d&&(b.style.top=d.y-b.offsetHeight/2+"px",b.style.left=d.x-b.offsetWidth/2+"px")},ColorPicker.fixIndicators=function(a,b){b.style.pointerEvents="none",a.style.pointerEvents="none"},s.ColorPicker=ColorPicker}(window,window.document);var Socket=function(){function Socket(){}return Socket.init=function(){if(null==this.addr)throw"Server Address is not configured in sock.js!";this.sock=new WebSocket(this.addr),this.sock.binaryType="arraybuffer",this.sock.onopen=this.onOpen,this.sock.onmessage=this.onRecv,this.sock.onerror=this.onError,this.sock.onclose=this.onClose},Socket.sendRaw=function(msg){this.sock.send(msg)},Socket.send=function(id,arr){this.sock.send(Message.pack(id,arr))},Socket.ping=function(){Socket.send(0,["ping"])},Socket.onOpen=function(e){null!=Socket.pingThread&&(clearInterval(Socket.pingThread),Socket.pingThread=null),ChatWindow.HideDisconnectedMessage(),Socket.send(1,Socket.args)},Socket.onRecv=function(e){var msg=Message.unpack(new Uint8Array(e.data)),parts=msg.parts,strs=parts.map(function(part){try{return part.toString()}catch(e){return""}});switch(console.log(msg.id),console.log(strs),msg.id){case 1:"1"==strs[0]&&(ChatWindow.Show(),Socket.send(5,["1","0"]));break;case 2:ChatWindow.AddMessage(parseInt(strs[6]),new User(parseInt(strs[1]),strs[2],strs[3],strs[4]),strs[5])}},Socket.onError=function(e){},Socket.onClose=function(e){Chat.shouldReconnect()&&(ChatWindow.ShowDisconnectedMessage(),Socket.init())},Socket.pingThread=null,Socket.kicked=!1,Socket}(),Title=function(){function Title(){}return Title.strobeCallback=function(){Title.enableStrobing||(Title.num=0),Title.num>0?(document.title=(Title.on?"[@ ]":"[ @]")+" "+Title.username+" - "+Title.chatTitle,Title.num--,Title.on=!Title.on):Title.Normalize()},Title.Strobe=function(name){""==Title.chatTitle&&(Title.chatTitle=document.title),Title.num=Title.startNum,Title.username=name,Title.started||(Title.started=!0,setInterval("Title.strobeCallback();",500))},Title.Normalize=function(){document.title=Title.chatTitle},Title.chatTitle="",Title.username="",Title.num=0,Title.startNum=6,Title.enableStrobing=!0,Title.started=!1,Title.on=!1,Title}(),ConnectionWindow=function(){function ConnectionWindow(){}return ConnectionWindow.Show=function(isLoadingChat){void 0===isLoadingChat&&(isLoadingChat=!1),document.getElementById("chat").className="hidden",document.getElementById("connectionMessage").className=isLoadingChat?"loadingChat":"",document.getElementById("connectionMessageSub").className=isLoadingChat?"hidden":""},ConnectionWindow.SetConnectionTitle=function(title){document.getElementById("connectionMessageTitle").innerHTML=title},ConnectionWindow}(),ChatWindow=function(){function ChatWindow(){}return ChatWindow.Show=function(){document.getElementById("chat").className="",document.getElementById("connectionMessage").className="hidden"},ChatWindow.AddMessage=function(msgid,user,msg){var chatmsg=document.createElement("div"),date=new Date,datespan=document.createElement("span");datespan.className="date",datespan.innerHTML="("+date.getHours().zeroPad()+":"+date.getMinutes().zeroPad()+":"+date.getSeconds().zeroPad()+")",chatmsg.appendChild(datespan),chatmsg.appendChild(document.createTextNode(" "));var userspan=document.createElement("span");userspan.style.fontWeight="bold",userspan.style.color=user.color,userspan.innerHTML=user.name.sanitize(),userspan.onclick=function(){},chatmsg.appendChild(userspan);var msgcolon=document.createElement("span");msgcolon.className="msgColon",msgcolon.innerHTML=": ",chatmsg.appendChild(msgcolon);var msgbreak=document.createElement("span");msgbreak.className="msgBreak",msgbreak.innerHTML="",chatmsg.appendChild(msgbreak),chatmsg.innerHTML+=msg.sanitize(),Title.Strobe(user.name),document.getElementById("chatList").appendChild(chatmsg),ChatWindow.ScrollToBottom()},ChatWindow.ShowDisconnectedMessage=function(){document.getElementById("disconnectMessage").className=""},ChatWindow.HideDisconnectedMessage=function(){document.getElementById("disconnectMessage").className="hidden"},ChatWindow.ScrollToBottom=function(){document.getElementById("chatList").scrollTop=document.getElementById("chatList").scrollHeight},ChatWindow}(),Permissions=function(){function Permissions(permstr){}return Permissions}(),User=function(){function User(id,name,color,perms){this.id=id,this.name=name,this.color=color,this.perms=new Permissions(perms)}return User}();!function(root){function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;length>counter;)value=string.charCodeAt(counter++),value>=55296&&56319>=value&&length>counter?(extra=string.charCodeAt(counter++),56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)):output.push(value);return output}function ucs2encode(array){for(var value,length=array.length,index=-1,output="";++index<length;)value=array[index],value>65535&&(value-=65536,output+=stringFromCharCode(value>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value);return output}function checkScalarValue(codePoint){if(codePoint>=55296&&57343>=codePoint)throw Error("Lone surrogate U+"+codePoint.toString(16).toUpperCase()+" is not a scalar value")}function createByte(codePoint,shift){return stringFromCharCode(codePoint>>shift&63|128)}function encodeCodePoint(codePoint){if(0==(4294967168&codePoint))return stringFromCharCode(codePoint);var symbol="";return 0==(4294965248&codePoint)?symbol=stringFromCharCode(codePoint>>6&31|192):0==(4294901760&codePoint)?(checkScalarValue(codePoint),symbol=stringFromCharCode(codePoint>>12&15|224),symbol+=createByte(codePoint,6)):0==(4292870144&codePoint)&&(symbol=stringFromCharCode(codePoint>>18&7|240),symbol+=createByte(codePoint,12),symbol+=createByte(codePoint,6)),symbol+=stringFromCharCode(63&codePoint|128)}function utf8encode(string){for(var codePoint,codePoints=ucs2decode(string),length=codePoints.length,index=-1,byteString="";++index<length;)codePoint=codePoints[index],byteString+=encodeCodePoint(codePoint);return byteString}function readContinuationByte(){if(byteIndex>=byteCount)throw Error("Invalid byte index");var continuationByte=255&byteArray[byteIndex];if(byteIndex++,128==(192&continuationByte))return 63&continuationByte;throw Error("Invalid continuation byte")}function decodeSymbol(){var byte1,byte2,byte3,byte4,codePoint;if(byteIndex>byteCount)throw Error("Invalid byte index");if(byteIndex==byteCount)return!1;if(byte1=255&byteArray[byteIndex],byteIndex++,0==(128&byte1))return byte1;if(192==(224&byte1)){var byte2=readContinuationByte();if(codePoint=(31&byte1)<<6|byte2,codePoint>=128)return codePoint;throw Error("Invalid continuation byte")}if(224==(240&byte1)){if(byte2=readContinuationByte(),byte3=readContinuationByte(),codePoint=(15&byte1)<<12|byte2<<6|byte3,codePoint>=2048)return checkScalarValue(codePoint),codePoint;throw Error("Invalid continuation byte")}if(240==(248&byte1)&&(byte2=readContinuationByte(),byte3=readContinuationByte(),byte4=readContinuationByte(),codePoint=(15&byte1)<<18|byte2<<12|byte3<<6|byte4,codePoint>=65536&&1114111>=codePoint))return codePoint;throw Error("Invalid UTF-8 detected")}function utf8decode(byteString){byteArray=ucs2decode(byteString),byteCount=byteArray.length,byteIndex=0;for(var tmp,codePoints=[];(tmp=decodeSymbol())!==!1;)codePoints.push(tmp);return ucs2encode(codePoints)}var freeExports="object"==typeof exports&&exports,freeModule="object"==typeof module&&module&&module.exports==freeExports&&module,freeGlobal="object"==typeof global&&global;(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal)&&(root=freeGlobal);var byteArray,byteCount,byteIndex,stringFromCharCode=String.fromCharCode,utf8={version:"2.0.0",encode:utf8encode,decode:utf8decode};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return utf8});else if(freeExports&&!freeExports.nodeType)if(freeModule)freeModule.exports=utf8;else{var object={},hasOwnProperty=object.hasOwnProperty;for(var key in utf8)hasOwnProperty.call(utf8,key)&&(freeExports[key]=utf8[key])}else root.utf8=utf8}(this),String.prototype.replaceAll=function(needle,replace,ignoreCase){if(void 0===ignoreCase&&(ignoreCase=!1),"string"==typeof needle)return this.replace(new RegExp(needle.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),ignoreCase?"gi":"g"),"string"==typeof replace?replace.replace(/\$/g,"$$$$"):replace);var retval=this;for(var i in needle)retval="string"==typeof replace?retval.replaceAll(needle[i],replace,ignoreCase):retval.replaceAll(needle[i],replace[i],ignoreCase);return retval},String.prototype.contains=function(needle,ignoreCase){return void 0===ignoreCase&&(ignoreCase=!1),ignoreCase?-1!=this.toLowerCase().indexOf(needle.toLowerCase()):-1!=this.indexOf(needle)},String.prototype.sanitize=function(){return this.replaceAll(["&",">","<","\n"],["&amp;","&gt;","&lt;"," <br /> "])},String.prototype.sanitizeRegex=function(){for(var out="",i=0;i<this.length;i++){var cc=this.charCodeAt(i);cc>47&&58>cc||cc>64&&91>cc||cc>96&&123>cc||(out+="\\"),out+=this.charAt(i)}return out},String.prototype.stripCharacters=function(chars){var copy=this;return""!=chars&&(copy=copy.replaceAll(chars.split(""),"")),copy},String.prototype.hasUnicodeCharacter=function(){for(var i=0;i<this.length;i++)if(this.charCodeAt(i)>127)return!0;return!1},String.prototype.byteLength=function(){return utf8.encode(this).length},String.prototype.toByteArray=function(){for(var str=utf8.encode(this),ret=new Uint8Array(str.length),i=0;i<str.length;i++)ret[i]=str.charCodeAt(i);return ret},HTMLSelectElement.prototype.getOptionByValue=function(value){for(var option in this.options)if(this.options[option].value==value)return this.options[option];return null},HTMLSelectElement.prototype.getIndexByValue=function(value){for(var option in this.options)if(this.options[option].value==value)return option;return-1},Date.unixNow=function(){return(new Date).toUnixTime()},Date.prototype.toUnixTime=function(){return Math.floor(this.getTime()/1e3)},Date.prototype.toDateTimeString=function(){return this.getTime()<0?UI.langs[UI.currentLang].menuText.eot:this.toDateString()+" @ "+this.getHours().zeroPad()+":"+this.getMinutes().zeroPad()+":"+this.getSeconds().zeroPad()},Date.prototype.toTimeString=function(){return this.getHours().zeroPad()+":"+this.getMinutes().zeroPad()+":"+this.getSeconds().zeroPad()},Number.prototype.zeroPad=function(mag){void 0===mag&&(mag=1);for(var ret=""+this;this<Math.pow(10,mag)&&0!=mag;--mag)ret="0"+ret;return ret},Number.prototype.packBytes=function(bytes){for(var ret=new Uint8Array(bytes),i=0;bytes>i;i++)ret[i]=(this&255<<8*(bytes-1-i))>>>8*(bytes-1-i);return ret},Uint8Array.prototype.unpackBytes=function(){for(var ret=0,i=0;i<this.length;i++)ret|=(255&this[i])<<8*(this.length-1-i);return ret},Uint8Array.prototype.toString=function(){for(var chunkSize=1e4,raw="",i=0;!(this.length<chunkSize*i);i++)raw+=String.fromCharCode.apply(null,this.subarray(chunkSize*i,chunkSize*i+chunkSize));return utf8.decode(raw)};var Utils=function(){function Utils(){}return Utils.formatBotMessage=function(type,id,params){return void 0===params&&(params=[]),type+"\f"+id+"\f"+params.join("\f")},Utils.fetchPage=function(url){var req=new XMLHttpRequest;return req.open("GET",url,!1),req.send(null),200===req.status?req.responseText:""},Utils.embedVideo=function(link){var id=link.parentElement.title,holder=link.parentElement.getElementsByTagName("span")[0];holder.innerHTML="link"==holder.title?"<iframe width='560' height='315' src='//www.youtube.com/embed/"+id+"' frameborder='0' allowfullscreen></iframe>":"<a href='https://www.youtube.com/watch?v="+id+"' onclick='window.open(this.href);return false;'>https://www.youtube.com/watch?v="+id+"</a>",link.innerHTML="link"==holder.title?"Remove":"Embed",holder.title="link"==holder.title?"video":"link"},Utils.embedImage=function(link){var id=link.parentElement.title,holder=link.parentElement.getElementsByTagName("span")[0],imglink=holder.getElementsByTagName("a")[0];imglink.innerHTML="link"==holder.title?"<img src='"+id+"' alt='userimg' class='insertImage' />":id,link.innerHTML="link"==holder.title?"Remove":"Embed",holder.title="link"==holder.title?"image":"link"},Utils.random=function(min,max){return Math.round(Math.random()*(max-min))+min},Utils}();